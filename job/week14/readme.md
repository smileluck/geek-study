[toc]

---

# 题目

**1.（选做）**思考一下自己负责的系统，或者做过的系统，能否描述清楚其架构。

**2.（选做）**考虑一下，如果让你做一个针对双十一，某东某宝半价抢 100 个 IPhone 的活动系统，你该如何考虑，从什么地方入手。

**3.（选做）**可以自行学习以下参考书的一两本。
推荐架构书籍：
《软件架构》Mourad Chabane Oussalah
《架构实战 - 软件架构设计的过程》Peter EeLes
《软件系统架构 - 使用视点和视角与利益相关者合作》Nick Rozanski
《企业 IT 架构转型之道》
《大型网站技术架构演进与性能优化》
《银行信息系统架构》
《商业银行分布式架构实践》

**4.（选做）**针对课上讲解的内容，自己动手设计一个高并发的秒杀系统，讲架构图， 设计文档等，提交到 GitHub。
**5.（选做）**针对自己工作的系统，或者自己思考的复杂场景，做系统性的架构设计。





# 作业2

先考虑一下流程。

![秒杀流程](\秒杀流程.png)

1. 首先是持久化存储，用数据库方式，
   - 商品活动，活动价格，数量，开始时间-结束时间。
   - 商品订单，购买数量，价格，实际支付价格，购买时间。
2. 因为活动商品数量只有100，假设现在有1000QPS。有可能在不作任何措施的情况下，导致超卖了。
   - 这里可以通过JUC中的lock来控制，但是性能会大大下降。
   - 也可以使用mysql+乐观锁的形式来解决，但性能上并不是最优的，因为涉及磁盘操作
   - 使用redis，因为redis是基于内存的，运行效率远高于其他两种方式，通过使用redis内存管理单线程的机制，来实现并发控制（采用）
3. 库存预热。因为数据库操作慢我们将活动商品id和数量写入redis。
4. 持久化写入订单，在抢购时检验redis数量，如果剩余，则通过kafka队列发送信息，在mysql创建订单，修改库存。
5. 限流。
   - 前端限流。避免前端一直点击，抢购后进入等待阶段，过几秒才可以再次抢购。
   - 后端限流。一旦100个商品卖完了，直接返回前端秒杀结束，后端也关闭无效请求进入。